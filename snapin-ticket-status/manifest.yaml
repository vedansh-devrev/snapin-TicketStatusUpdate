version: "1"

name: "e2e_snap_in"
description: "A snap-in to notify part owners on ticket status change"

connections:
  - name: devrev
    description: DevRev PAT
    types:
      - devrev-pat

event-sources:
  - name: devrev-webhook
    description: Event coming from Devrev
    display_name: Devrev
    type: devrev-webhook
    config:
      event_types:
        - work_updated

globals:
  - name: ticket_id
    description: ID of the ticket which transitioned to another state.
    devrev_field_type: id 
    devrev_id_type:
      - product 
  - name: message 
    description: Message to post on newly created work's timeline. 
    devrev_field_type: tokens 

functions:
  - name: ticket-status-update
    description: Function containing logic to create a timeline entry on ticket status change to "Awaiting Product Assist".

automations:
  - name: Create a timeline entry on ticket status change to "Awaiting Product Assist".
    source: devrev-webhook
    event_types:
      - work_updated
    function: ticket-status-update
